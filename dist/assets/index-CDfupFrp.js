const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Signup-B2N03nmt.js","assets/vendor-C22lMxs3.js","assets/Button-C2gHDiQh.js","assets/Login-CzLJYDe-.js","assets/VerifyMobile-Im_fVaQR.js","assets/userApi-C5VETMzr.js","assets/AdminDashboard-DFygVGZx.js","assets/UserDashboard-cFKWkZ80.js","assets/Cart-B0v-Lg3t.js","assets/UserOrders-DOhGhG5J.js"])))=>i.map(i=>d[i]);
import{i as k,g as I,G as O,r as a,j as e,R as h,O as R,a as C,b as p,N as j,o as N,u as S,c as D,d as y,V as E,e as V,B as z}from"./vendor-C22lMxs3.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))u(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&u(l)}).observe(document,{childList:!0,subtree:!0});function r(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function u(t){if(t.ep)return;t.ep=!0;const s=r(t);fetch(t.href,s)}})();const T="modulepreload",U=function(n){return"/"+n},_={},x=function(i,r,u){let t=Promise.resolve();if(r&&r.length>0){let l=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),m=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));t=l(r.map(c=>{if(c=U(c),c in _)return;_[c]=!0;const d=c.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":T,d||(f.as="script"),f.crossOrigin="",f.href=c,m&&f.setAttribute("nonce",m),document.head.appendChild(f),d)return new Promise((w,A)=>{f.addEventListener("load",w),f.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return t.then(l=>{for(const o of l||[])o.status==="rejected"&&s(o.reason);return i().catch(s)})},$={apiKey:"AIzaSyAqX2UKQgFuy0AAlDXwzrZGvwFgEsQ5ePQ",authDomain:"mvps-7adb0.firebaseapp.com",projectId:"mvps-7adb0",storageBucket:"mvps-7adb0.appspot.com",messagingSenderId:"617672630606",appId:"1:617672630606:web:25dcaa6f784e266e677e1f"},B=k($),b=I(B),P=new O;P.addScope("profile");P.addScope("email");const L=a.createContext(),F=()=>a.useContext(L);function q({children:n}){const[i,r]=a.useState([]),[u,t]=a.useState(()=>{const m=localStorage.getItem("mvps-cart-stationery");return m?JSON.parse(m):[]});a.useEffect(()=>{localStorage.setItem("mvps-cart-stationery",JSON.stringify(u))},[u]);const s=(m,c)=>{m==="print"?r(d=>[...d,c]):t(d=>[...d,c])},l=(m,c)=>{m==="print"?r(d=>d.filter((g,f)=>f!==c)):t(d=>d.filter((g,f)=>f!==c))},o=()=>{r([]),t([]),localStorage.removeItem("mvps-cart-stationery")};return e.jsx(L.Provider,{value:{cartItems:{print:i,stationery:u},addToCart:s,removeFromCart:l,clearCart:o},children:n})}const G=h.lazy(()=>x(()=>import("./Signup-B2N03nmt.js"),__vite__mapDeps([0,1,2]))),K=h.lazy(()=>x(()=>import("./Login-CzLJYDe-.js"),__vite__mapDeps([3,1,2]))),Q=h.lazy(()=>x(()=>import("./VerifyMobile-Im_fVaQR.js"),__vite__mapDeps([4,1,5,2]))),J=h.lazy(()=>x(()=>import("./AdminDashboard-DFygVGZx.js"),__vite__mapDeps([6,1,2,5]))),X=h.lazy(()=>x(()=>import("./UserDashboard-cFKWkZ80.js"),__vite__mapDeps([7,1,2]))),Y=h.lazy(()=>x(()=>import("./Cart-B0v-Lg3t.js"),__vite__mapDeps([8,1,2]))),M=h.lazy(()=>x(()=>import("./UserOrders-DOhGhG5J.js"),__vite__mapDeps([9,1,2])));function W({children:n}){const{clearCart:i}=F(),[r,u]=a.useState(!1);return a.useEffect(()=>N(b,s=>{s||i(),u(!0)}),[]),r?n:e.jsx("div",{className:"text-center mt-10",children:"Loading…"})}function v({children:n}){const[i,r]=a.useState("checking"),u=S(),t=D();return a.useEffect(()=>{(async()=>{const s=b.currentUser;if(!s){r("redirectLogin");return}if(u.pathname==="/verify-mobile"){r("ok");return}try{const l=await y.get(`/api/get-role?email=${s.email}`);if(!["user","admin"].includes(l.data.role)){r("redirectLogin");return}const o=await y.get(`/api/get-profile?email=${s.email}`);if(o.data.blocked){E.error("Your account has been blocked."),r("blocked");return}if(!o.data.mobileVerified){r("verify");return}r("ok")}catch{r("redirectLogin")}})()},[u.pathname,t]),i==="checking"?e.jsx("div",{className:"text-center mt-10",children:"Checking access…"}):i==="redirectLogin"||i==="blocked"?e.jsx(j,{to:"/login",replace:!0}):i==="verify"?e.jsx(j,{to:"/verify-mobile",replace:!0}):n}function Z({children:n}){const[i,r]=a.useState(null),u=S();return a.useEffect(()=>{(async()=>{const t=b.currentUser;if(!t){r(!1);return}try{if((await y.get(`/api/get-role?email=${t.email}`)).data.role!=="admin"){r(!1);return}if((await y.get(`/api/get-profile?email=${t.email}`)).data.blocked){E.error("Your account has been blocked."),r(!1);return}r(!0)}catch{r(!1)}})()},[u.pathname]),i===null?e.jsx("div",{className:"text-center mt-10",children:"Checking access…"}):i?n:e.jsx(j,{to:"/userdashboard",replace:!0})}function H(){const n=e.jsx("div",{className:"text-center mt-10",children:"Loading…"});return e.jsx(q,{children:e.jsxs(W,{children:[e.jsx(R,{position:"top-center"}),e.jsxs(C,{children:[e.jsx(p,{path:"/",element:e.jsx(j,{to:"/login",replace:!0})}),e.jsx(p,{path:"/login",element:e.jsx(a.Suspense,{fallback:n,children:e.jsx(K,{})})}),e.jsx(p,{path:"/signup",element:e.jsx(a.Suspense,{fallback:n,children:e.jsx(G,{})})}),e.jsx(p,{path:"/verify-mobile",element:e.jsx(a.Suspense,{fallback:n,children:e.jsx(Q,{})})}),e.jsx(p,{path:"/userdashboard",element:e.jsx(v,{children:e.jsx(a.Suspense,{fallback:n,children:e.jsx(X,{})})})}),e.jsx(p,{path:"/cart",element:e.jsx(v,{children:e.jsx(a.Suspense,{fallback:n,children:e.jsx(Y,{})})})}),e.jsx(p,{path:"/orders",element:e.jsx(v,{children:e.jsx(a.Suspense,{fallback:n,children:e.jsx(M,{})})})}),e.jsx(p,{path:"/admin",element:e.jsx(Z,{children:e.jsx(a.Suspense,{fallback:n,children:e.jsx(J,{})})})}),e.jsx(p,{path:"*",element:e.jsx("div",{className:"text-center text-red-500 mt-10",children:"404 - Page Not Found"})})]})]})})}typeof window<"u"&&window.eruda&&window.eruda.destroy();V.createRoot(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx(z,{basename:"/",children:e.jsx(H,{})})}));export{b as a,P as g,F as u};
